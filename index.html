<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>블루 아카이브 전술 시뮬레이터</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Do+Hyeon&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css" />
</head>
<body>
    <div class="game">
        <header class="game__header">
            <h1>샬레 전술 훈련</h1>
        </header>

        <main class="game__main">
            <section class="game__enemy">
                <div class="enemy__info">
                    <div id="enemyName" class="enemy__name">훈련용 타깃</div>
                    <div class="enemy__health-bar">
                        <div id="enemyHealthBar" class="enemy__health-bar-fill"></div>
                    </div>
                    <div class="enemy__health">
                        <span id="enemyCurrentHp">10</span> / <span id="enemyMaxHp">10</span>
                    </div>
                    <div id="bossTimer" class="boss-timer" aria-live="polite"></div>
                </div>
                <div id="enemy" class="enemy">
                    <div class="enemy__sprite"></div>
                    <div id="damageIndicator" class="damage-indicator"></div>
                </div>
                <button id="tapButton" class="btn btn-primary">공격!</button>
                <div id="bossControls" class="boss-controls">
                    <button id="bossRetreat" class="btn btn-ghost boss-control__button" type="button">보스 퇴각</button>
                    <button id="bossAdvance" class="btn btn-secondary boss-control__button" type="button">보스 돌입</button>
                </div>
                <div class="game__enemy-stats">
                    <div class="game__stats">
                        <div class="stat">
                            <span class="stat__label">스테이지</span>
                            <span id="stage" class="stat__value">1</span>
                        </div>
                        <div class="stat">
                            <span class="stat__label">골드</span>
                            <span id="gold" class="stat__value">0</span>
                        </div>
                        <div class="stat">
                            <span class="stat__label">강화 재료</span>
                            <span id="upgradeMaterials" class="stat__value">0</span>
                        </div>
                        <div class="stat">
                            <span class="stat__label">모집권</span>
                            <span id="gachaTokensHeader" class="stat__value">0</span>
                        </div>
                        <div class="stat">
                            <span class="stat__label">전술 공격력</span>
                            <span id="clickDamage" class="stat__value">1</span>
                        </div>
                        <div class="stat">
                            <span class="stat__label">총 지원 화력</span>
                            <span id="totalDps" class="stat__value">0</span>
                        </div>
                        <div class="stat">
                            <span class="stat__label">치명타 확률</span>
                            <span id="critChance" class="stat__value">0%</span>
                        </div>
                        <div class="stat">
                            <span class="stat__label">치명타 배율</span>
                            <span id="critMultiplier" class="stat__value">0배</span>
                        </div>
                    </div>
                </div>
                <div class="game__progress">
                    <div class="progress-track" id="stageProgressTrack"></div>
                </div>
            </section>

            <aside class="game__panel">
                <div id="panelOverlayBackdrop" class="panel-overlay__backdrop" aria-hidden="true"></div>
                <nav class="panel-tabs" role="tablist" aria-label="보조 패널">
                    <button
                        type="button"
                        class="panel-tab is-active"
                        id="tab-heroes"
                        role="tab"
                        aria-selected="true"
                        aria-controls="panel-heroes"
                        data-tab-target="heroes"
                    >
                        학생
                    </button>
                    <button
                        type="button"
                        class="panel-tab"
                        id="tab-recruit"
                        role="tab"
                        aria-selected="false"
                        aria-controls="panel-recruit"
                        data-tab-target="recruit"
                        tabindex="-1"
                    >
                        학생 모집
                    </button>
                    <button
                        type="button"
                        class="panel-tab"
                        id="tab-rebirth"
                        role="tab"
                        aria-selected="false"
                        aria-controls="panel-rebirth"
                        data-tab-target="rebirth"
                        tabindex="-1"
                    >
                        환생
                    </button>
                    <button
                        type="button"
                        class="panel-tab"
                        id="tab-equipment"
                        role="tab"
                        aria-selected="false"
                        aria-controls="panel-equipment"
                        data-tab-target="equipment"
                        tabindex="-1"
                    >
                        전술 장비
                    </button>
                    <button
                        type="button"
                        class="panel-tab"
                        id="tab-missions"
                        role="tab"
                        aria-selected="false"
                        aria-controls="panel-missions"
                        data-tab-target="missions"
                        tabindex="-1"
                    >
                        임무
                    </button>
                    <button
                        type="button"
                        class="panel-tab"
                        id="tab-log"
                        role="tab"
                        aria-selected="false"
                        aria-controls="panel-log"
                        data-tab-target="log"
                        tabindex="-1"
                    >
                        전투 로그
                    </button>
                </nav>

                <div class="panel-views">
                    <button
                        type="button"
                        id="panelOverlayClose"
                        class="panel-overlay__close"
                        aria-hidden="true"
                        tabindex="-1"
                        aria-label="보조 패널 닫기"
                    >
                        닫기 ✕
                    </button>
                    <div
                        class="panel-view is-active"
                        id="panel-heroes"
                        role="tabpanel"
                        aria-labelledby="tab-heroes"
                        data-tab="heroes"
                    >
                        <section class="panel panel--hero">
                            <header class="panel__header">
                                <h2>학생</h2>
                                <button id="sortHeroes" class="btn btn-secondary">정렬 순서 변경</button>
                            </header>
                            <ul id="heroList" class="hero-list"></ul>
                        </section>

                        <section class="panel panel--set-bonus">
                            <header class="panel__header">
                                <h2>전술 세트 효과</h2>
                                <span id="setBonusSummary" class="set-bonus__summary">발동 중인 세트 없음</span>
                            </header>
                            <ul id="setBonusList" class="set-bonus-list"></ul>
                        </section>

                        <section class="panel panel--upgrades">
                            <header class="panel__header">
                                <h2>샬레 지원 센터</h2>
                            </header>
                            <div class="upgrade">
                                <div>
                                    <h3>전술 교육 프로그램</h3>
                                    <p>학생의 기본 공격력을 강화합니다.</p>
                                </div>
                                <button id="upgradeClick" class="btn btn-upgrade">전술 교육 (10 골드)</button>
                                <p id="clickUpgradeInfo" class="upgrade__info" aria-live="polite"></p>
                            </div>
                            <div class="upgrade">
                                <div>
                                    <h3>정밀 사격 교정</h3>
                                    <p>전술 분석으로 클릭 치명타 확률을 향상시킵니다.</p>
                                </div>
                                <button id="upgradeCritChance" class="btn btn-upgrade">정밀 교정 (50 골드)</button>
                                <p id="critChanceUpgradeInfo" class="upgrade__info" aria-live="polite"></p>
                            </div>
                            <div class="upgrade">
                                <div>
                                    <h3>특수 탄두 연구</h3>
                                    <p>치명타 발생 시 피해 배율을 높입니다.</p>
                                </div>
                                <button id="upgradeCritDamage" class="btn btn-upgrade">탄두 연구 (75 골드)</button>
                                <p id="critDamageUpgradeInfo" class="upgrade__info" aria-live="polite"></p>
                            </div>
                            <div class="upgrade">
                                <div>
                                    <h3>지원 화력 지휘 과정</h3>
                                    <p>학생 전체의 DPS를 영구적으로 증가시킵니다.</p>
                                </div>
                                <button id="upgradeHeroDps" class="btn btn-upgrade">지휘 과정 (100 골드)</button>
                                <p id="heroDpsUpgradeInfo" class="upgrade__info" aria-live="polite"></p>
                            </div>
                            <div class="upgrade">
                                <div>
                                    <h3>지원 치명 분석 훈련</h3>
                                    <p>지원 부대의 전술 데이터를 분석해 치명타 확률을 높입니다.</p>
                                </div>
                                <button id="upgradeHeroCritChance" class="btn btn-upgrade">치명 분석 (150 골드)</button>
                                <p id="heroCritChanceUpgradeInfo" class="upgrade__info" aria-live="polite"></p>
                            </div>
                            <div class="upgrade">
                                <div>
                                    <h3>지원 치명타 보강 훈련</h3>
                                    <p>전술 장비를 보강해 학생들의 치명타 피해량을 끌어올립니다.</p>
                                </div>
                                <button id="upgradeHeroCritDamage" class="btn btn-upgrade">치명타 보강 (175 골드)</button>
                                <p id="heroCritDamageUpgradeInfo" class="upgrade__info" aria-live="polite"></p>
                            </div>
                            <div class="upgrade">
                                <div>
                                    <h3>자금 운용 훈련</h3>
                                    <p>현장 예산 편성 훈련으로 획득 골드량을 늘립니다.</p>
                                </div>
                                <button id="upgradeGoldGain" class="btn btn-upgrade">자금 운용 훈련 (125 골드)</button>
                                <p id="goldGainUpgradeInfo" class="upgrade__info" aria-live="polite"></p>
                            </div>
                            <div class="upgrade">
                                <div>
                                    <h3>아로나의 전술 지원</h3>
                                    <p>샬레의 지원 네트워크로 잠시 총 지원 화력을 2배로 높입니다.</p>
                                </div>
                                <button id="skillFrenzy" class="btn btn-skill">지원 요청 (쿨타임 60초)</button>
                                <p id="skillCooldown" class="cooldown"></p>
                            </div>
                        </section>
                    </div>

                    <div
                        class="panel-view"
                        id="panel-recruit"
                        role="tabpanel"
                        aria-labelledby="tab-recruit"
                        data-tab="recruit"
                        hidden
                    >
                        <section class="panel panel--recruit" aria-label="학생 모집">
                            <header class="panel__header">
                                <h2>학생 모집</h2>
                            </header>
                            <section class="gacha-panel" aria-label="학생 모집">
                                <div class="gacha-panel__header">
                                    <div>
                                        <h3 class="gacha-panel__title">학생 모집</h3>
                                        <p class="gacha-panel__hint">보스를 처치하면 일정 확률로 모집권을 획득합니다.</p>
                                    </div>
                                    <div class="gacha-panel__tokens">
                                        <span class="gacha-panel__tokens-label">보유 모집권</span>
                                        <strong id="gachaTokens" class="gacha-panel__tokens-value">0</strong>
                                    </div>
                                </div>
                                <div class="gacha-panel__actions">
                                    <button id="gachaSingle" class="btn btn-gacha" type="button">1회 모집 (1)</button>
                                    <button id="gachaTen" class="btn btn-gacha" type="button">10회 모집 (9)</button>
                                </div>
                                <p class="gacha-panel__notice">10회 모집 시 1회는 무료로 진행됩니다.</p>
                                <div class="gacha-panel__rates">
                                    <h4 class="gacha-panel__rates-title">희귀도별 출현 확률</h4>
                                    <ul id="gachaRateList" class="gacha-rate-list" aria-label="희귀도별 가챠 확률"></ul>
                                </div>
                                <div class="gacha-panel__pool">
                                    <h4 class="gacha-panel__pool-title">학생별 출현 정보</h4>
                                    <ul id="gachaPoolList" class="gacha-pool-list" aria-label="학생별 가챠 정보"></ul>
                                </div>
                                <ul
                                    id="gachaResults"
                                    class="gacha-results"
                                    aria-live="polite"
                                    aria-label="최근 가챠 결과"
                                ></ul>
                                <p id="gachaResultsEmpty" class="gacha-results__empty">아직 모집 기록이 없습니다.</p>
                            </section>
                        </section>
                    </div>

                    <div
                        class="panel-view"
                        id="panel-rebirth"
                        role="tabpanel"
                        aria-labelledby="tab-rebirth"
                        data-tab="rebirth"
                        hidden
                    >
                        <section class="panel panel--rebirth" id="rebirthPanel">
                            <header class="panel__header">
                                <h2>환생</h2>
                            </header>
                            <div class="rebirth__summary">
                                <div class="rebirth__stat">
                                    <span class="rebirth__label">환생 횟수</span>
                                    <strong id="rebirthCount">0</strong>
                                </div>
                                <div class="rebirth__stat">
                                    <span class="rebirth__label">최고 도달 층</span>
                                    <strong id="rebirthHighestStage">0</strong>
                                </div>
                                <div class="rebirth__stat">
                                    <span class="rebirth__label">이번 획득 예상 (보너스 적용)</span>
                                    <strong id="rebirthPotential">0</strong>
                                </div>
                                <div class="rebirth__stat">
                                    <span class="rebirth__label">보유 포인트</span>
                                    <strong id="rebirthPoints">0</strong>
                                </div>
                            </div>
                            <button id="rebirthButton" class="btn btn-rebirth" disabled>환생하기</button>
                            <p id="rebirthRequirement" class="rebirth__requirement">100층을 돌파하면 환생할 수 있습니다.</p>
                            <div class="rebirth__skills">
                                <h3 class="rebirth__subheading">환생 스킬</h3>
                                <ul id="rebirthSkillList" class="rebirth-skill-list"></ul>
                            </div>
                        </section>
                    </div>

                    <div
                        class="panel-view"
                        id="panel-equipment"
                        role="tabpanel"
                        aria-labelledby="tab-equipment"
                        data-tab="equipment"
                        hidden
                    >
                        <section class="panel panel--equipment">
                            <header class="panel__header">
                                <h2>전술 장비</h2>
                            </header>
                            <p id="equipmentSummary" class="equipment__summary" aria-live="polite">
                                클릭 데미지 +0.0% · 지원 화력 +0.0% · 전술 스킬 +0.0% · 골드 획득 +0.0% · 치명타 확률 +0.0%
                                · 치명타 피해 +0.0%
                            </p>
                            <div class="equipment__bonuses">
                                <div class="equipment__bonus">
                                    <span>클릭 데미지</span>
                                    <strong id="equipmentTapBonus">+0.0%</strong>
                                </div>
                                <div class="equipment__bonus">
                                    <span>지원 화력</span>
                                    <strong id="equipmentHeroBonus">+0.0%</strong>
                                </div>
                                <div class="equipment__bonus">
                                    <span>전술 스킬</span>
                                    <strong id="equipmentSkillBonus">+0.0%</strong>
                                </div>
                                <div class="equipment__bonus">
                                    <span>골드 획득</span>
                                    <strong id="equipmentGoldBonus">+0.0%</strong>
                                </div>
                                <div class="equipment__bonus">
                                    <span>치명타 확률</span>
                                    <strong id="equipmentCritChanceBonus">+0.0%</strong>
                                </div>
                                <div class="equipment__bonus">
                                    <span>치명타 피해</span>
                                    <strong id="equipmentCritDamageBonus">+0.0%</strong>
                                </div>
                            </div>
                            <div class="equipment__section">
                                <h3 class="equipment__subheading">장착 장비</h3>
                                <ul id="equipmentSlots" class="equipment-slots"></ul>
                            </div>
                            <div class="equipment__section">
                                <h3 class="equipment__subheading">인벤토리</h3>
                                <div class="equipment__controls">
                                    <p id="equipmentSalvageHint" class="equipment__hint">
                                        잠긴 전술 장비는 분해되지 않습니다. <strong>분해 가능한 장비만 보기</strong>
                                        옵션이나 <strong>분해 가능 전체 선택</strong> 버튼으로 손쉽게 정리하세요.
                                        <span
                                            id="equipmentSelectionCount"
                                            class="equipment__hint-count"
                                            aria-live="polite"
                                        >
                                            현재 선택: 없음
                                        </span>
                                    </p>
                                    <div class="equipment__control-bar">
                                        <label class="equipment__filter">
                                            <input type="checkbox" id="equipmentFilterSalvageable" />
                                            분해 가능한 장비만 보기
                                        </label>
                                        <button
                                            id="equipmentSelectSalvageable"
                                            class="btn btn-secondary btn-small"
                                            type="button"
                                        >
                                            분해 가능 전체 선택
                                        </button>
                                        <button
                                            id="equipmentSalvageSelected"
                                            class="btn btn-danger btn-small"
                                            type="button"
                                            disabled
                                        >
                                            선택 분해
                                        </button>
                                    </div>
                                </div>
                                <ul id="equipmentInventory" class="equipment-list"></ul>
                                <p id="equipmentEmpty" class="equipment-empty">아직 확보한 전술 장비가 없습니다.</p>
                            </div>
                        </section>
                    </div>

                    <div
                        class="panel-view"
                        id="panel-missions"
                        role="tabpanel"
                        aria-labelledby="tab-missions"
                        data-tab="missions"
                        hidden
                    >
                        <section class="panel panel--missions">
                            <header class="panel__header">
                                <h2>임무</h2>
                            </header>
                            <p id="missionSummary" class="mission__summary">
                                샬레의 지시를 수행해 보상을 획득하세요.
                            </p>
                            <ul id="missionList" class="mission-list"></ul>
                            <p id="missionEmpty" class="mission-empty">모든 임무를 완료했습니다!</p>
                        </section>
                    </div>

                    <div
                        class="panel-view"
                        id="panel-log"
                        role="tabpanel"
                        aria-labelledby="tab-log"
                        data-tab="log"
                        hidden
                    >
                        <section class="panel panel--log">
                            <header class="panel__header">
                                <h2>전투 로그</h2>
                            </header>
                            <ul id="log" class="log"></ul>
                        </section>
                    </div>
                </div>
            </aside>
        </main>

        <footer class="game__footer">
            <div>
                <button id="resetProgress" class="btn btn-secondary">초기화</button>
                <button id="saveProgress" class="btn btn-secondary">즉시 저장</button>
            </div>
            <p class="game__footer-text">비영리 블루 아카이브 팬게임을 위한 브라우저 전술 시뮬레이터 데모입니다.</p>
        </footer>
    </div>

    <div id="salvageModal" class="modal" hidden>
        <div id="salvageModalOverlay" class="modal__overlay">
            <div class="modal__dialog" role="dialog" aria-modal="true" aria-labelledby="salvageModalTitle">
                <h3 id="salvageModalTitle" class="modal__title">전술 장비 분해 확인</h3>
                <p class="modal__description">선택한 전술 장비를 분해하면 다음 보상을 획득합니다.</p>
                <ul id="salvageModalList" class="modal__list"></ul>
                <div class="modal__summary">
                    <span id="salvageModalCount">선택된 장비 0개</span>
                    <span id="salvageModalRewards">강화 재료 0개 · 골드 0</span>
                </div>
                <div class="modal__actions">
                    <button id="salvageModalCancel" class="btn btn-secondary btn-small" type="button">취소</button>
                    <button id="salvageModalConfirm" class="btn btn-danger btn-small" type="button">분해 진행</button>
                </div>
            </div>
        </div>
    </div>

    <template id="heroTemplate">
        <li class="hero" data-recruited="false" data-rarity="common">
            <div class="hero__info">
                <div class="hero__header">
                    <span class="hero__rarity"></span>
                    <h3 class="hero__name"></h3>
                </div>
                <p class="hero__desc"></p>
                <div class="hero__meta">
                    <span class="hero__level"></span>
                    <span class="hero__dps"></span>
                </div>
                <div class="hero__traits" role="list" aria-label="학생 특성"></div>
                <div class="hero__appearance">
                    <div class="hero__skin-preview" data-locked="true" aria-hidden="true">
                        <img
                            class="hero__skin-preview-image"
                            alt=""
                            loading="lazy"
                            decoding="async"
                            hidden
                        />
                    </div>
                    <div class="hero__skin-list" role="group" aria-label="스킨 선택"></div>
                </div>
            </div>
            <div class="hero__status">
                <span class="hero__status-state"></span>
                <span class="hero__status-detail"></span>
            </div>
        </li>
    </template>

    <script type="module" src="src/main.js"></script>
</body>
</html>
